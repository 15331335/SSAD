# 用例建模

> 这是关于用例建模学习的知识汇总和实践。



## 什么是用例建模？

用讲故事的手段（自然语言故事），描述通过人机交互达成用户目标的过程。

它特别关注用户看到或期望系统处理的数据。



## 用例建模的制品有哪些？

- UML Usecase Diagram

- 用例描述
  - 用例文本
    - 简洁的用例文本（Brief）
    - 非正式的用例文本（Casual）
    - 详尽的用例文本（Detailed）
  - 故事板（Storyboard）
    - User interface-flow diagram
    - UI Prototypes




## 如何进行敏捷需求管理？

- 管理方法，如《硝烟中的 Scrum 和 XP》
- 管理工具，如 TAPD 腾讯敏捷产品开发




## 如何识别与组织需求？

### 合理的用例识别（制作的用例图）给团队的利益

- 明确系统的业务范围、服务对象（角色）、外部系统与设备
- 帮助识别技术风险，提前实施关键技术原型公关与学习
- 易于评估项目工作量，合理规划迭代周期，规划人力需要


### 需求识别的步骤

1. 确定研讨的系统
   - 使用用例图 System 框，表示一个待研究的系统
   - 正确命名系统或子系统
   - **不要将研究的系统的名称起的太泛，以避免业务空泛问题**
2. 识别 Actors
   - 识别使用系统的主要参与者（primary actors）或角色（roles）
     - 使用用例图 Actor 符号表示，通常放在系统的左边
     - 企业应用可以通过企业组织架构，业务角色与职责识别
     - 互联网应用则必须通过市场分析，确定受众范围
     - **不要用「用户」代表系统使用者，以避免过于通用导致缺乏用户体验**
   - 识别系统依赖的外部系统
     - 使用用例图 Neighboursystem 框表示用例依赖的外部系统（<<system>>）、服务（<<service>>） 、设备（<<device>> 或 <<sensor>>），并使用构造型（Stereotype）识别
     - **将一些专业功能赋予专业系统，以确保系统的简洁与专业**
3. 识别用例（服务）
   - 识别用户级别用例（user goal level）
     - 以主要参与者目标驱动，收集主要参与者的业务事件
     - 必须满足 boss / EBP / Size test准则
   - 识别子功能级别的用例（sub function level）
     - 子用例特征：业务复用、复杂业务分解、强调技术或业务创新
     - 正确使用用例与子用例之间的关系
       - <<include>> 表示子用例是父用例的一部分，通常强调离开这个特性，父用例无法达成目标或失去意义
       - <<extend>> 表示子用例是父用例的可选场景或技术特征
       - 箭头表示的依赖关系，<<include>> 箭头指向子用例，<<extend>> 箭头指向父用例
4. 建立 Actor 和 Use Cases 之间的关联
   - 使用**无方向连线**，表示两间之间是双向交互的协议


### 组织与跟踪需求

- 用树形结构组织需求

  ```c++
  -- system or sub system
    |-- usecase
      |-- sub usecase
      |-- scene
      |-- feature
  ```

- 可以投产的需求或特征
  - 一个迭代可以完成编码与测试
  - 可以独立测试




## 按需求组织生产

### TAPD 的需求创建方法

1. **什么是需求 Backlog**

   需求 Backlog 是产品待实现的需求列表， Backlog 中的需求按照对用户的价值排序。

2. **为 Backlog 创建需求**

   需求是敏捷中的 User Story，从用户角度描述的独立的功能点。需求描述包括：

   > As a …（作为...角色或岗位）
   >
   > I want…（我想...希望做什么）
   >
   > So that…（以便…达到什么目的或商业价值）

3. **划分优先级**

   为每个需求按照用户价值划分优先级

4. **拆分需求**

   将需求进行拆分，拆分到以用户角度可接受的最小颗粒度功能作为子需求，子需求是可以规划到迭代中的需求。

### 《硝烟中的 Scrum 和 XP》的教程

#### 我们怎样编写产品 backlog

> 产品 backlog 是 Scrum 的核心，也是一切的起源。从根本上说，它就是一个需求、或故事、或特性等组成的**列表**，按照重要性的级别进行了**排序**。它里面包含的是客户想要的东西，并用客户的术语加以描述。

我们叫它故事（story），有时候也叫做 backlog 条目。我们的故事包括这样一些字段：

- **ID**：统一标识符，就是个自增长的数字而已。以防重命名故事以后找不到它们。

- **Name**（名称）：简短的、描述性的故事名。比如「查看你自己的交易明细」。它必须要含义明确，这样开发人员和产品负责人才能大致明白我们说的是什么东西，跟其他故事区分开。它一般由 2 到 10 个字组成。

- **Importance**（重要性）：产品负责人评出一个数值，指示这个故事有多重要。例如 10 或 150，分数越高越重要。

  ⚠️ 我一直都想避免「优先级」这个说法，因为一般说来优先级1都表示「最高」优先级，如果后来有其他更重要的东西就麻烦了。它的优先级评级应该是什么呢？优先级 0？优先级 -1？

- **Initialestimate**（初始估算）：团队的初步估算，表示与其他故事相比，完成该故事所需的工作量。最小的单位是故事点（storypoint），一般大致相当于一个「理想的人日（man-day）」。

  ⚠️ 问一下你的团队，「如果可以投入最适合的人员来完成这个故事（人数要适中，通常为 2 个），把你们锁到一个屋子里，有很多食物，在完全没有打扰的情况下工作，那么需要几天，才能给出一个经过测试验证，可以交付的完整实现呢？」，如果答案是「把3个人关在一起，大约需要4天时间」，那么初始估算的结果就是12个故事点。

  ⚠️ 不需要保证这个估值绝对无误（比如两个故事点的故事就应该花两天时间），而是要保证相对的正确性（即两个点的故事所花费的时间应该是四个点的故事所需的一半）。

- **Howtodemo**（如何做演示）：它大略描述了这个故事应该如何在 sprint 演示上进行示范，本质就是一个简单的测试规范。「先这样做，然后那样做，就应该得到……的结果」。

  ⚠️ 如果你在使用 TDD（测试驱动开发），那么这段描述就可以作为验收测试的伪码表示。

- **Notes**（注解）：相关信息、解释说明和对其它资料的引用等等。一般都非常简短。



**产品 BACKLOG（示例）**：

| ID   | Name               | Imp  | Est  | How to demo                                                  | Notes                                                      |
| ---- | ------------------ | ---- | ---- | ------------------------------------------------------------ | ---------------------------------------------------------- |
| 1    | 存款               | 30   | 5    | 登录，打开存款界面，存入 10 欧元，转到我的账户余额界面，检查我的余额增加了 10 欧元。 | 需要 UML顺序图。目前不需要考虑加密的问题。                 |
| 2    | 查看自己的交易明细 | 10   | 8    | 登录，点击「交易」，存入一笔款项，返回交易页面，看到新的存款显示在页面上。 | 使用分页避免大规模的数据库查询。和查看用户列表的设计相似。 |

⚠️ 我们曾试过很多字段，但最后发现，只有上面提到的六个字段我们会一直使用下去。

⚠️ 通常我们会**把 backlog 存放在共享的 Excel 文档**里面（是为了多个用户可以同时编辑它）。虽然正规意义上这个文档应该归产品负责人所有，但是我们并不想把其他用户排斥在外。开发人员常常要打开这个文档，弄清一些事情，或者修改估算值。

⚠️ 基于同样原因，我们没有把这个文档放到版本控制仓库上，而是放到共享的驱动器里面。我们发现，要想保证多用户同时编辑而不会导致锁操作或是合并冲突，这是最简单的方式。

⚠️ 但是基本上其它所有的制品都放在了版本控制仓库中。



#### 我们怎样准备 sprint 计划

在 sprint 计划会议之前，要确保产品 backlog 的井然有序。

- 产品 backlog 必须存在。

- 只能有一个产品 backlog 和一个产品负责人（对于一个产品而言）。

- 所有重要的 backlog 条目都已经根据重要性被评过分，不同的重要程度对应不同的分数。

  ⚠️ 其实，重要程度比较低的 backlog 条目，评分相同也没关系，因为它们在这次 sprint 计划会议上可能根本不会被提出来。

  ⚠️ 无论任何故事，只要产品负责人相信它会在下一个 sprint 实现，那它就应该被划分到一个特有的重要性层次。

  ⚠️ 分数只是用来根据重要性对 backlog 条目排序。假如 A 的分数是 20，而 B 的分数是 100，那仅仅是说明 B 比 A 重要而已，绝不意味着 B 比 A 重要五倍。如果 B 的分数是 21 而不是 100，含义也是一样的！

  ⚠️ 最好在分数之间留出适当间隔，以防后面出现一个 C，比 A 重要而不如 B 重要。当然我们也可以给 C 打一个 20.5 分，但这样看上去就很难看了，所以我们还是留出间隔来！

- 产品负责人应当理解每个故事的含义（通常故事都是由他来编写的，但是有的时候其他人也会添加一些请求，产品负责人对它们划分先后次序）。他不需要知道每个故事具体是如何实现的，但是他要知道为什么这个故事会在这里。

  ⚠️ 产品负责人之外的人也可以向产品 backlog 中添加故事，**但是他们不能说这个故事有多重要**，这是产品负责人独有的权利。**他们也不能添加时间估算，这是开发团队独有的权利**。



## 实践与参考

### 实践

- **Dinner Now**
- **Reserve Hotel**

### 参考

- [User interface-flow diagram](http://agilemodeling.com/artifacts/uiFlowDiagram.htm)
- [UI Prototypes](http://agilemodeling.com/artifacts/uiPrototype.htm)
- [编写有效用例（中／英）](http://download.csdn.net/detail/zyg345382708/3094197)
- [使用用例点估算软件成本](https://www.ibm.com/developerworks/cn/rational/edge/09/mar09/collaris_dekker/index.html)